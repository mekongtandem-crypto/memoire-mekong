<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêò M√©moire du M√©kong V0.1</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lucide { width: 1em; height: 1em; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // ===== ICONS LUCIDE =====
        const Home = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>;
        const Users = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="m22 21-2-2"/></svg>;
        const User = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
        const Play = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"/></svg>;
        const Camera = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>;
        const Cloud = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/></svg>;
        const Settings = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="M12.22 2h-.44a2 2 0 0 0-2 2.18l.2 1.81c-.26.06-.51.14-.76.23l-1.5-1.16a2 2 0 0 0-2.83.32l-.22.38a2 2 0 0 0 .32 2.83l1.16 1.5c-.09.25-.17.5-.23.76l-1.81.2a2 2 0 0 0-2.18 2v.44a2 2 0 0 0 2.18 2l1.81.2c.06.26.14.51.23.76l-1.16 1.5a2 2 0 0 0-.32 2.83l.38.22a2 2 0 0 0 2.83-.32l1.5-1.16c.25.09.5.17.76.23l.2 1.81a2 2 0 0 0 2 2.18h.44a2 2 0 0 0 2-2.18l.2-1.81c.26-.06.51-.14.76-.23l1.5 1.16a2 2 0 0 0 2.83-.32l.22-.38a2 2 0 0 0-.32-2.83l-1.16-1.5c.09-.25.17-.5.23-.76l1.81-.2a2 2 0 0 0 2.18-2v-.44a2 2 0 0 0-2.18-2l-1.81-.2c-.06-.26-.14-.51-.23-.76l1.16-1.5a2 2 0 0 0 .32-2.83l-.38-.22a2 2 0 0 0-2.83.32l-1.5 1.16c-.25-.09-.5-.17-.76-.23l-.2-1.81a2 2 0 0 0-2-2.18Z"/><circle cx="12" cy="12" r="3"/></svg>;
        const ChevronLeft = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg>;
        const ChevronRight = ({ className = "" }) => <svg className={`lucide ${className}`} viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg>;

        // ===== CORE STORAGE =====
        const Storage = {
            get: (key, defaultValue = null) => {
                try {
                    const item = localStorage.getItem(`mekong_${key}`);
                    return item ? JSON.parse(item) : defaultValue;
                } catch { return defaultValue; }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(`mekong_${key}`, JSON.stringify(value));
                    return true;
                } catch { return false; }
            },
            remove: (key) => localStorage.removeItem(`mekong_${key}`),
            clear: () => {
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('mekong_')) localStorage.removeItem(key);
                });
            }
        };

        // ===== CORE STATES =====
        const useAppState = () => {
            const [currentPage, setCurrentPage] = React.useState('home');
            const [currentUser, setCurrentUser] = React.useState(Storage.get('currentUser', ''));
            
            // Sauvegarde automatique
            React.useEffect(() => {
                Storage.set('currentUser', currentUser);
            }, [currentUser]);

            const resetApp = () => {
                setCurrentPage('home');
                setCurrentUser('');
                Storage.clear();
            };

            return {
                currentPage, setCurrentPage,
                currentUser, setCurrentUser,
                resetApp
            };
        };

        // ===== USER CONFIG =====
        const USERS = {
            tom: { name: 'Tom l\'√©l√©phantau', color: 'blue', emoji: 'üêò' },
            lambert: { name: 'Lambert, le Vieil √©l√©phant', color: 'green', emoji: 'üêò' },
            duo: { name: 'Duo Mekong Tandem', color: 'amber', emoji: 'üêòüêò' }
        };

        const getUserStyle = (userKey) => {
            const user = USERS[userKey];
            if (!user) return { bg: 'bg-gray-100', border: 'border-gray-300', text: 'text-gray-800' };
            
            const styles = {
                blue: { bg: 'bg-blue-100 hover:bg-blue-200', border: 'border-blue-300', text: 'text-blue-800' },
                green: { bg: 'bg-green-100 hover:bg-green-200', border: 'border-green-300', text: 'text-green-800' },
                amber: { bg: 'bg-amber-100 hover:bg-amber-200', border: 'border-amber-300', text: 'text-amber-800' }
            };
            return styles[user.color] || styles.blue;
        };

        // ===== NAVIGATION COMPONENT =====
        const Navigation = ({ currentPage, currentUser, onPageChange, onUserChange }) => (
            <div className="bg-white/90 backdrop-blur rounded-xl shadow-lg p-4 mb-6">
                <div className="flex justify-between items-center">
                    {/* User Button */}
                    <div>
                        {currentUser ? (
                            <button
                                onClick={() => onUserChange('')}
                                className={`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-all ${getUserStyle(currentUser).bg} ${getUserStyle(currentUser).border}`}
                                title="Changer d'utilisateur"
                            >
                                <span>{USERS[currentUser]?.emoji}</span>
                                <span className={`font-medium ${getUserStyle(currentUser).text}`}>
                                    {USERS[currentUser]?.name}
                                </span>
                                <ChevronRight className="w-4 h-4 opacity-60" />
                            </button>
                        ) : (
                            <button
                                onClick={() => onPageChange('home')}
                                className="flex items-center space-x-2 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-100 transition-all"
                                title="Choisir un utilisateur"
                            >
                                <User className="w-4 h-4 text-gray-500" />
                                <span className="font-medium text-gray-600">Utilisateur</span>
                            </button>
                        )}
                    </div>

                    {/* Page Navigation */}
                    <div className="flex items-center space-x-1">
                        {['home', 'sessions', 'memories', 'settings'].map((page) => {
                            const icons = { home: Home, sessions: Play, memories: Cloud, settings: Settings };
                            const labels = { home: 'Accueil', sessions: 'Sessions', memories: 'M√©moires', settings: 'R√©glages' };
                            const Icon = icons[page];
                            
                            return (
                                <button
                                    key={page}
                                    onClick={() => onPageChange(page)}
                                    disabled={!currentUser && page !== 'home'}
                                    className={`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${
                                        currentPage === page 
                                            ? 'bg-amber-200 text-amber-800' 
                                            : !currentUser && page !== 'home'
                                            ? 'text-gray-400 cursor-not-allowed'
                                            : 'hover:bg-gray-100 text-gray-600'
                                    }`}
                                >
                                    <Icon className="w-4 h-4" />
                                    <span className="text-sm font-medium">{labels[page]}</span>
                                </button>
                            );
                        })}
                    </div>
                </div>
            </div>
        );

        // ===== MAIN PAGES =====
        const HomePage = ({ currentUser, onUserChange, onPageChange }) => (
            <div className="space-y-6 fade-in">
                <div className="text-center">
                    <h2 className="text-2xl font-bold text-amber-900 mb-4">
                        Bienvenue dans vos m√©moires du M√©kong
                    </h2>
                    {currentUser && (
                        <p className="text-amber-700 mb-6">
                            Bonjour <strong>{USERS[currentUser]?.name}</strong> ! Que souhaitez-vous faire aujourd'hui ?
                        </p>
                    )}
                </div>

                {!currentUser ? (
                    <div className="max-w-md mx-auto space-y-4">
                        <h3 className="text-lg font-semibold text-amber-900 text-center">Qui √™tes-vous ?</h3>
                        <div className="space-y-3">
                            <button
                                onClick={() => onUserChange('tom')}
                                className={`flex items-center space-x-3 p-4 border-2 rounded-lg w-full text-left transition-all ${getUserStyle('tom').bg} hover:${getUserStyle('tom').border}`}
                            >
                                <span className="text-3xl">üêò</span>
                                <div>
                                    <div className={`font-medium text-lg ${getUserStyle('tom').text}`}>Tom l'√©l√©phantau</div>
                                    <div className="text-sm text-gray-600">Le jeune aventurier</div>
                                </div>
                            </button>
                            <button
                                onClick={() => onUserChange('lambert')}
                                className={`flex items-center space-x-3 p-4 border-2 rounded-lg w-full text-left transition-all ${getUserStyle('lambert').bg} hover:${getUserStyle('lambert').border}`}
                            >
                                <span className="text-3xl">üêò</span>
                                <div>
                                    <div className={`font-medium text-lg ${getUserStyle('lambert').text}`}>Lambert, le Vieil √©l√©phant</div>
                                    <div className="text-sm text-gray-600">Le sage guide</div>
                                </div>
                            </button>
                            <button
                                onClick={() => onUserChange('duo')}
                                className={`flex items-center space-x-3 p-4 border-2 rounded-lg w-full text-left transition-all ${getUserStyle('duo').bg} hover:${getUserStyle('duo').border}`}
                            >
                                <span className="text-3xl">üêòüêò</span>
                                <div>
                                    <div className={`font-medium text-lg ${getUserStyle('duo').text}`}>Duo Mekong Tandem</div>
                                    <div className="text-sm text-gray-600">Session p√®re-fils</div>
                                </div>
                            </button>
                        </div>
                    </div>
                ) : (
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer" onClick={() => onPageChange('sessions')}>
                            <div className="text-center">
                                <Play className="w-12 h-12 text-blue-600 mx-auto mb-4" />
                                <h3 className="text-lg font-semibold text-gray-900 mb-2">Sessions</h3>
                                <p className="text-gray-600 text-sm">Cr√©er ou reprendre une session de rem√©moration</p>
                            </div>
                        </div>
                        <div className="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer" onClick={() => onPageChange('memories')}>
                            <div className="text-center">
                                <Cloud className="w-12 h-12 text-green-600 mx-auto mb-4" />
                                <h3 className="text-lg font-semibold text-gray-900 mb-2">M√©moires</h3>
                                <p className="text-gray-600 text-sm">Explorer le blog Mastodon et les photos</p>
                            </div>
                        </div>
                        <div className="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer" onClick={() => onPageChange('settings')}>
                            <div className="text-center">
                                <Settings className="w-12 h-12 text-purple-600 mx-auto mb-4" />
                                <h3 className="text-lg font-semibold text-gray-900 mb-2">R√©glages</h3>
                                <p className="text-gray-600 text-sm">Configuration et pr√©f√©rences</p>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        );

        const SessionsPage = () => (
            <div className="space-y-6 fade-in">
                <h2 className="text-2xl font-bold text-amber-900">Sessions de rem√©moration</h2>
                <div className="bg-blue-50 p-6 rounded-lg border border-blue-200 text-center">
                    <p className="text-blue-800 mb-4">üöß Module Sessions en cours de d√©veloppement</p>
                    <p className="text-blue-600 text-sm">Prochaine √©tape : Catalogue de jeux + Sessions collaboratives</p>
                </div>
            </div>
        );

        const MemoriesPage = () => (
            <div className="space-y-6 fade-in">
                <h2 className="text-2xl font-bold text-amber-900">M√©moires du voyage</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                        <div className="text-center">
                            <Cloud className="w-12 h-12 text-blue-600 mx-auto mb-4" />
                            <h3 className="text-lg font-semibold text-blue-900 mb-2">Blog Mastodon</h3>
                            <p className="text-blue-700 text-sm mb-4">275 posts du voyage √† explorer</p>
                            <div className="bg-blue-100 p-3 rounded text-blue-800 text-sm">
                                üöß Import et navigation - Prochaine √©tape
                            </div>
                        </div>
                    </div>
                    <div className="bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border border-green-200">
                        <div className="text-center">
                            <Camera className="w-12 h-12 text-green-600 mx-auto mb-4" />
                            <h3 className="text-lg font-semibold text-green-900 mb-2">Photos</h3>
                            <p className="text-green-700 text-sm mb-4">2000+ photos organis√©es par jour</p>
                            <div className="bg-green-100 p-3 rounded text-green-800 text-sm">
                                üöß API DirectoryPicker - Prochaine √©tape
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );

        const SettingsPage = ({ onReset }) => (
            <div className="space-y-6 fade-in">
                <h2 className="text-2xl font-bold text-amber-900">R√©glages</h2>
                <div className="bg-white p-6 rounded-lg shadow-md space-y-4">
                    <div>
                        <h3 className="text-lg font-semibold text-gray-900 mb-2">Donn√©es</h3>
                        <button 
                            onClick={() => {
                                if (confirm('‚ö†Ô∏è Effacer toutes les donn√©es sauvegard√©es ?')) onReset();
                            }}
                            className="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium"
                        >
                            üóëÔ∏è Reset complet
                        </button>
                    </div>
                    <div className="pt-4 border-t border-gray-200">
                        <h4 className="font-medium text-gray-700 mb-2">Stockage actuel</h4>
                        <div className="text-sm text-gray-600">
                            <div>Utilisateur: {Storage.get('currentUser') || 'Non d√©fini'}</div>
                        </div>
                    </div>
                </div>
            </div>
        );

        // ===== MAIN APP =====
        const MemoireMekong = () => {
            const {
                currentPage, setCurrentPage,
                currentUser, setCurrentUser,
                resetApp
            } = useAppState();

            return (
                <div className="min-h-screen bg-gradient-to-br from-amber-50 to-orange-100 p-4">
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-6">
                            <h1 className="text-4xl font-bold text-amber-900 mb-2">üêò M√©moire du M√©kong</h1>
                            <p className="text-amber-700">V0.1 ‚Ä¢ Architecture modulaire ‚Ä¢ 23 ao√ªt 2025</p>
                        </div>

                        {/* Navigation */}
                        <Navigation 
                            currentPage={currentPage}
                            currentUser={currentUser}
                            onPageChange={setCurrentPage}
                            onUserChange={setCurrentUser}
                        />

                        {/* Main Content */}
                        <div className="bg-white/80 backdrop-blur rounded-xl shadow-lg p-6">
                            {currentPage === 'home' && (
                                <HomePage 
                                    currentUser={currentUser}
                                    onUserChange={setCurrentUser}
                                    onPageChange={setCurrentPage}
                                />
                            )}
                            {currentPage === 'sessions' && <SessionsPage />}
                            {currentPage === 'memories' && <MemoriesPage />}
                            {currentPage === 'settings' && <SettingsPage onReset={resetApp} />}
                        </div>

                        {/* Footer */}
                        <div className="text-center mt-6 text-amber-700 text-sm">
                            <p>üêò Un voyage, deux m√©moires, mille souvenirs üêò</p>
                            <p className="text-xs opacity-75 mt-1">
                                ‚úÖ Core + Navigation ‚Ä¢ ‚è≥ Sessions + Photos + Mastodon
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // ===== RENDER =====
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(MemoireMekong));
    </script>
</body>
</html>
